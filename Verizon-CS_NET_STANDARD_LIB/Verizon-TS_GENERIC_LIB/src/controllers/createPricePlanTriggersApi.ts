/**
 * VerizonLib
 *
 * This file was automatically generated by APIMATIC v3.0 ( https://www.apimatic.io ).
 */

import { ApiResponse, RequestOptions } from '../core';
import {
  CreateTriggerRulesBody,
  createTriggerRulesBodySchema,
} from '../models/containers/createTriggerRulesBody';
import {
  TriggerResponse,
  triggerResponseSchema,
} from '../models/triggerResponse';
import { BaseApi } from './baseApi';
import { RuleRestErrorResponseError } from '../errors/ruleRestErrorResponseError';

export class CreatePricePlanTriggersApi extends BaseApi {
  /**
   * Create a usage trigger at the account level, device level or a price plan trigger for all devices on
   * the account
   *
   * @param body         Create a trigger
   * @return Response from the API call
   */
  async createTriggerRules(
    body: CreateTriggerRulesBody,
    requestOptions?: RequestOptions
  ): Promise<ApiResponse<TriggerResponse>> {
    const req = this.createRequest('POST', '/v2/triggers');
    req.baseUrl('Thingspace');
    const mapped = req.prepareArgs({
      body: [body, createTriggerRulesBodySchema],
    });
    req.header('Content-Type', 'application/json');
    req.json(mapped.body);
    req.defaultToError(RuleRestErrorResponseError, 'Error response');
    req.authenticate([{ thingspaceOauth1: true }, { vzM2MToken: true }]);
    return req.callAsJson(triggerResponseSchema, requestOptions);
  }
}
