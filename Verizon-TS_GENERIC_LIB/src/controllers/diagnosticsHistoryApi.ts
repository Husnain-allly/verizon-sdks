/**
 * VerizonLib
 *
 * This file was automatically generated by APIMATIC v3.0 ( https://www.apimatic.io ).
 */

import { ApiResponse, RequestOptions } from '../core';
import { History, historySchema } from '../models/history';
import {
  HistorySearchRequest,
  historySearchRequestSchema,
} from '../models/historySearchRequest';
import { array } from '../schema';
import { BaseApi } from './baseApi';
import { DeviceDiagnosticsResultError } from '../errors/deviceDiagnosticsResultError';

export class DiagnosticsHistoryApi extends BaseApi {
  /**
   * This endpoint allows the user to get the history data.
   *
   * @param body         History data information.
   * @return Response from the API call
   */
  async getDiagnosticsHistory(
    body: HistorySearchRequest,
    requestOptions?: RequestOptions
  ): Promise<ApiResponse<History[]>> {
    const req = this.createRequest('POST', '/history/actions/$search');
    req.baseUrl('Device Diagnostics');
    const mapped = req.prepareArgs({
      body: [body, historySearchRequestSchema],
    });
    req.header('Content-Type', '*/*');
    req.json(mapped.body);
    req.defaultToError(DeviceDiagnosticsResultError, 'Error response.');
    req.authenticate([{ thingspaceOauth: true, vzM2MToken: true }]);
    return req.callAsJson(array(historySchema), requestOptions);
  }
}
